<div class="show-banner-overlay">
    <div class="show-banner" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('<%= cl_image_path(@musician.banner_photo) %>');">
      <div class="musician-show-banner-content">
        <div class="show-nickname">
          <%= @musician.nickname.capitalize %>
        </div>
          <h4><%= @musician.tag_line %></h4>

      </div>
    </div>
</div>


<div class="container">
  <div class="musicians-show-container">
    <div class="show-musician-pic-wrapper">
      <%= cl_image_tag(@musician.user_photo, class:"show-musician-photo") %>
      <div class="s-musician-pic-overlay">
      </div>
    </div>

      <div class="gray-detail-container">
        <div class="gray-info-contents">
          <div class="gray-name">
            <% @musician.fullname.split(' ').each do |m| %>
              <%= m.capitalize %>
            <% end %>
          </div>
          <div class="gray-bio">
            <p ><%= @musician.description %></p>
          </div>
          <div class="gray-eq">
            <%
              instruments = @musician.equipments.map do |e|
                e.equipment_type.capitalize
              end
            %>
            <%= instruments.join(" · ") %>
          </div>
          <div class="gray-other-info">
            <% unless @musician.genres.nil? %>
              <p>Genre:
                <%
                  genres = []
                  @musician.genres.each do |genre|
                    genres << genre.name.capitalize
                  end
                %>
                <%= genres.join(' · ') %>
              </p>
            <% end %>
              <p>Location: <%= @musician.location.capitalize %></p>
          </div>

            <input type="checkbox" style="display: none;" id="m-review">
            <label for="m-review" class='btn btn-link m-review-b'>View all the reviews</label>
            <script>
              // const request = document.getElementById('request-label')
              // request.style.borderBottom = '4px solid #9745AF'
              $(document).ready(function() {
                $("#m-review").change(function(){
                  if(this.checked){
                    $(".musician-review")[0].style.display = "block";
                  } else {
                    $(".musician-review")[0].style.display = "none";
                  }
                })
              });
            </script>
            <div class="musician-review" style='display: none;'>
              <% if @reviews.exists? %>
                <% @reviews.each do |r| %>
                  <%= r.content %>
                  <%= r.stars %>
                <% end %>
                <div class="create-review-container">
                  <input type="checkbox" style="display: none;" id="m-write-review">
                  <label for="m-write-review" class='btn btn-primary'>Write review</label>
                  <script>
                    $(document).ready(function() {
                      $("#m-write-review").change(function(){
                        if(this.checked){
                          $("#create-review")[0].style.display = "block";
                        } else {
                          $("#create-review")[0].style.display = "none";
                        }
                      })
                    });
                  </script>
                </div>

                <div id="create-review" style='display: none;'>
                  <%= simple_form_for [@musician, @review] do |f| %>
                    <%= f.input :content %>
                    <%= f.input :stars  %>
                    <%= f.submit "Send", class: "btn btn-success review-submit" %>
                  <% end %>
                </div>
              <% else %>
                <p><%= 'No reviews yet.' %></p>
                <div id="create-message">
                  <p class='btn btn-primary'><%= 'Write review' %></p>
                  <%= simple_form_for [@musician, @review] do |f| %>
                    <%= f.input :content %>
                    <%= f.input :stars  %>
                    <%= f.submit "Send", class: "btn btn-success message-submit" %>
                  <% end %>
                </div>
              <% end %>
            </div>

          <% unless @musician.bands.empty? %>
            <div class="gray-view-bands">
              <ps>Bands:</p>
              <ul>
                <% @musician.bands.each do |band| %>
                  <li><%= band.band_name.capitalize %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

        </div>
      </div>
  </div>
</div>

<% if user_signed_in? && current_user != @musician %>
<p class='want-to text-center'>Want to play with <%= @musician.nickname %>?</p>
  <div id="connect">
    <% if @requested %>
      <%= link_to "You have sent a request.", musicians_path, class: "btn btn-secondary disabled align-center", :disabled => true %>
    <% else %>
      <%= simple_form_for @request, wrapper: :inline_form, html: { class: 'form-inline' } do |f| %>
        <%= f.input :to_id, :as => :hidden, :input_html => { :value => @musician.id } %>
        <%= f.input :band_id, collection: @musicians_bands, class: 'form-control', selected: 0 %>
        <%= f.input :message, placeholder: 'Message' %>
        <%= f.button :submit, 'Connect', class: "btn btn-primary connect" %>
      <% end %>
    <% end %>
  </div>
<% end %>

